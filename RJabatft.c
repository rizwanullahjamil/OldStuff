#include <stdio.h>
#include <time.h>

static const char *S[121] = {
  "r1c1", "r1c2", "r1c3", "r1c4", "r1c5", "r1c6", "r1c7", "r1c8", "r1c9", "r1c10", "r1c11",
  "r2c1", "r2c2", "r2c3", "r2c4", "r2c5", "r2c6", "r2c7", "r2c8", "r2c9", "r2c10", "r2c11",
  "r3c1", "r3c2", "r3c3", "r3c4", "r3c5", "r3c6", "r3c7", "r3c8", "r3c9", "r3c10", "r3c11",
  "r4c1", "r4c2", "r4c3", "r4c4", "r4c5", "r4c6", "r4c7", "r4c8", "r4c9", "r4c10", "r4c11",
  "r5c1", "r5c2", "r5c3", "r5c4", "r5c5", "r5c6", "r5c7", "r5c8", "r5c9", "r5c10", "r5c11",
  "r6c1", "r6c2", "r6c3", "r6c4", "r6c5", "r6c6", "r6c7", "r6c8", "r6c9", "r6c10", "r6c11",
  "r7c1", "r7c2", "r7c3", "r7c4", "r7c5", "r7c6", "r7c7", "r7c8", "r7c9", "r7c10", "r7c11",
  "r8c1", "r8c2", "r8c3", "r8c4", "r8c5", "r8c6", "r8c7", "r8c8", "r8c9", "r8c10", "r8c11",
  "r9c1", "r9c2", "r9c3", "r9c4", "r9c5", "r9c6", "r9c7", "r9c8", "r9c9", "r9c10", "r9c11",
  "r10c1", "r10c2", "r10c3", "r10c4", "r10c5", "r10c6", "r10c7", "r10c8", "r10c9", "r10c10", "r10c11",
  "r11c1", "r11c2", "r11c3", "r11c4", "r11c5", "r11c6", "r11c7", "r11c8", "r11c9", "r11c10", "r11c11"},
  int m[8] = {  2, 24, 22, 20, -2,-24,-22,-20};

int move (int p, int q)
{
  
}

int main (void)
{
/* V1
  int g[121] = { 30,  0,  0,  0, 24,  0,  0,  0,  0,  0,  0,
                 -1, -1,  0, -1, -1,  0,  0, 40,  8,  0,  0,
                 31,  0,  0, -1, -1,  0, -1, -1,  0, -1, -1,
                 -1, -1,  0,  0,  0,  0, -1, -1,  0,  0,  0,
                  0,  0, -1,  0, -1, 58, 18,  0,  0, -1, -1,
                 81,  0, -1, 44, -1,  0, -1,  0, -1,  0,  1,
                  0,  0, -1,  0, -1,  0,  0,  0, 17, -1, -1,
                 -1, -1,  0,  0,  0,  0, -1, -1,  0,  0,  0,
                  0,  0, 37, -1, -1,  0, -1, -1,  0, -1, -1,
                 -1, -1,  0, -1, -1, 70,  0,  0,  0, 79,  4,
                  0,  0,  0,  0,  0,  0,  0, 62,  0,  0, 52},
// V2
  int g[121] = {  0,  0, 44,  0,  0,  0,  0, 12,  0,  0,  0,
                 -1, -1,  0, -1, -1,  0,  0,  0,  0,  0,  0,
                 41,  0,  0, -1, -1,  0, -1, -1,  0, -1, -1,
                 -1, -1,  0,  0,  0,  0, -1, -1,  0,  0, 67,
                  0,  0, -1, 28, -1,  0, 58,  0,  0, -1, -1,
                 81,  0, -1,  1, -1, 16, -1,  0, -1,  0,  0,
                  0,  0, -1,  0, -1,  0, 57, 33,  0, -1, -1,
                 -1, -1,  0,  0, 49,  0, -1, -1,  0,  0,  0,
                  0,  0,  0, -1, -1,  0, -1, -1,  0, -1, -1,
                 -1, -1,  0, -1, -1, 10,  0,  0,  6,  0,  0,
                  0, 62, 73,  0,  0, 22,  0,  0,  0,  0,  0},
V3 */
  int g[121] = { -1, -1,  0, -1, -1,  0, -1, -1,  0, -1, -1,
                 -1,  0,  0, 30,  6, -1,  5, 53,  0,  0, -1,
                 -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, -1,
                  0, -1, 22,  0,  0, 54,  0,  0,  8, -1,  0,
                 67, -1,  0, 62, -1, -1, -1, 64,  0, -1, 15,
                 81,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,
                 39, -1,  0, 34, -1, -1, -1, 36,  0, -1, 13,
                  0, -1, 71,  0,  0, 78,  0,  0,  2, -1,  0,
                 -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, -1,
                 -1,  0,  0, 58, 70, -1, 47, 75,  0,  0, -1,
                 -1, -1,  0, -1, -1,  0, -1, -1,  0, -1, -1},
      s[121],
      r[81] = {0},
      d[81] = {0},
      i = 0,
      j = 0;

  for (; j < 121; ++j)
    if ((s[j] = g[j]) > 0)
	  r[g[j] - 1] = j;
  for (j = 0; j < 81; ++j)
    printf ("%d ", r[j]);
  printf ("\n");
  do
  {
    if (s[r[i + 1]] == i + 2)
    {
      for (j = 0; j < 8; ++j)
        if (r[i] + m[j] == r[i + 1])
          break;
      if (j < 8)
      {
   	    d[i] = j;
        printf ("(%d)%s s=%d m=%d d=%d (%d)%s s=%d\n", i + 1, S[r[i]], s[r[i]], j, m[j], i + 2, S[r[i + 1]], s[r[i + 1]]);
        ++i;
      }
      else
        --i;
      continue;
    }
    printf ("(%d)%s s=%d m=%d d=%d ", i + 1, S[r[i]], s[r[i]], d[i], m[d[i]]);
    r[++i] = r[i - 1] + m[d[i - 1]];
    if (m[d[i - 1]] > 0)
    {
      if (r[i] > (r[i] / 9) * 9 + 10)
        r[i] -= 11;
      if (r[i] > 120)
        r[i] -= 120;
    }
    else
    {
      if (r[i] < (r[i] / 9) * 9)
        r[i] += 11;
      if (r[i] < 0)
        r[i] += 120;
    }
    printf ("(%d)%s %d ", i + 1, S[r[i]], s[r[i]]);
    if (s[r[i]])
    {
      printf ("- Rollback\n");
      do
      {
   	    r[i] = d[i] = 0;
        s[r[i]] = g[r[i]];
        ++d[--i];
      }
      while (i > -1 && d[i] > 7);
      if (i < 0)
        break;
      continue;
    }
    if (i > 79)
      break;
    s[r[i]] = i + 1;
  }
  while (i < 81);
  if (i < 0)
    printf (" - No solution !!!\n");
  else
  {
    printf ("\nSolution:\n");
    for (j = 0; j < 81; ++j)
      printf ("(%d)%s\n", j, S[r[j]]);
  }
  printf ("End\n");
}
